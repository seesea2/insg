!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t){e.exports=require("express")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(21);t.ObjectID=o.ObjectID;var u,i="mongodb+srv://admin:admin@cluster0-dxwkg.mongodb.net/insg?retryWrites=true";function a(){return r(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.MongoClient.connect(i,{useNewUrlParser:!0})];case 1:return e=t.sent(),[2,u=e.db("insg")];case 2:throw t.sent(),"Database connection failed.";case 3:return[2]}}))}))}t.MongoDb=function(){return r(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:if(u)return[2,u];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a()];case 2:return e.sent(),[2,u];case 3:throw e.sent();case 4:return[2]}}))}))},t.DbCollection=function(e){return r(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(u)return[2,u.collection(e)];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a()];case 2:return t.sent(),[2,u.collection(e)];case 3:throw t.sent();case 4:return[2]}}))}))}},function(e,t){e.exports=require("axios")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.busArrivalUrl="http://datamall2.mytransport.sg/ltaodataservice/BusArrivalv2";t.busStopsUrl="http://datamall2.mytransport.sg/ltaodataservice/BusStops";var r={headers:{AccountKey:"6sVzf9zXRaCgkJUdjxIw2A=="}};t.headerConfig=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),u=n(3),i=[];function a(e){return r(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=u.busStopsUrl,e&&(t+="?$skip="+e),[4,o.default.get(t,u.headerConfig)];case 1:if(200!=(n=r.sent()).status)throw{status:n.status};return[2,n.data.value];case 2:throw r.sent();case 3:return[2]}}))}))}function c(e){if(e)for(var t=0;t<i.length;t++)if(e===i[t].BusStopCode)return i[t]}t.busStops=i,function e(){return r(this,void 0,void 0,(function(){var n,r,o;return s(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,,6]),n=0,r=[],s.label=1;case 1:return[4,a(n)];case 2:r=s.sent(),o=i,t.busStops=i=o.concat(r),n+=500,s.label=3;case 3:if(500===r.length)return[3,1];s.label=4;case 4:return[3,6];case 5:return s.sent(),t.busStops=i=[],e(),[3,6];case 6:return[2]}}))}))}(),t.checkBusStopLocally=c,t.getBusStopInfo=function(e,t){if(!e)return t.status(400).send("Invalid Bus Stop Code.");var n=c(e);return n?t.status(200).send(n):t.status(400).send("Bus Stop Info not found.")},t.getNearbyBusStops=function(e,t,n){if(void 0===e||void 0===t)return n.status(400).send("Invalid coordinates.");for(var r=[],s=0;s<i.length;s++){var o=(i[s].Latitude-e)*Math.PI/180,u=(i[s].Longitude-t)*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i[s].Latitude*Math.PI/180)*Math.cos(e*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2),c=6371e3*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));Math.abs(c)<280&&r.push(i[s])}n.status(200).send(r)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.GetInventory=function(e){return r(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,o.DbCollection("gifts-inventory")];case 1:return[4,r.sent().find().toArray()];case 2:return t=r.sent(),[2,e.status(200).send(t)];case 3:return n=r.sent(),[2,e.status(500).send(n.message)];case 4:return[2]}}))}))},t.AdjustInventory=function(e,t,n){return r(this,void 0,void 0,(function(){var r,u;return s(this,(function(s){switch(s.label){case 0:if(!e||!t)return[2,n.status(400).send("Invalid input.")];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,o.DbCollection("gifts-inventory")];case 2:return[4,s.sent().updateOne({_id:new o.ObjectID(e)},{$set:{modifiedOn:new Date,qty:t}},{upsert:!0})];case 3:return r=s.sent(),[2,n.status(200).send(r)];case 4:return u=s.sent(),[2,n.status(500).send(u)];case 5:return[2]}}))}))},t.ReserveInventory=function(e,t){return r(this,void 0,void 0,(function(){var n,r,u,i;return s(this,(function(s){switch(s.label){case 0:if(!t||t.length<=0)throw"The cart is empty.";s.label=1;case 1:return s.trys.push([1,7,,8]),n=[],r=[],[4,o.DbCollection("gifts-inventory")];case 2:u=s.sent(),i=0,s.label=3;case 3:return i<t.length?[4,u.updateOne({_id:new o.ObjectID(t[i].product._id),qty:{$gte:t[i].qty}},{$inc:{qty:-t[i].qty},$push:{reservations:{qty:t[i].qty,_id:new o.ObjectID(e),createdOn:new Date}}})]:[3,6];case 4:if(0===s.sent().result.nModified)return r.push(t[i].product),[3,6];n.push(t[i].product),s.label=5;case 5:return i++,[3,3];case 6:if(r.length>0){for(i=0;i<n.length;i++)u.updateOne({_id:n[i]._id,"reservations._id":e},{$inc:{qty:n[i].qty},$pull:{reservations:{_id:e}}});throw"Not enough storage."}return[2,"Success."];case 7:throw s.sent();case 8:return[2]}}))}))},t.DeleteInventoryReservation=function(e){return r(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,o.DbCollection("gifts-inventory")];case 1:return[4,r.sent().updateOne({"reservations._id":new o.ObjectID(e)},{$pull:{reservations:{_id:new o.ObjectID(e)}}})];case 2:if((t=r.sent()).result.nModified<=0)throw"delete reservation failed.";return[2,t];case 3:throw n=r.sent(),console.log(n),"delete reservation failed with exception.";case 4:return[2]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),u=n(7);function i(e){return!(!e||!e.user)}r(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,o.DbCollection("gifts-users")];case 1:return e.sent().createIndex("uid",{unique:!0}),[2]}}))})),t.Login=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return s(this,(function(s){switch(s.label){case 0:if(e.session&&e.session.user)return[2,t.status(200).send({uid:e.session.user.uid})];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,o.DbCollection("gifts-users")];case 2:return n=s.sent(),r=e.session,[4,n.findOne({uid:e.body.uid,pwd:u.encrypt(e.body.pwd)})];case 3:return r.user=s.sent(),e.session.user?[2,t.status(200).send({uid:e.session.user.uid})]:[2,t.status(403).send("Incorrect username or password")];case 4:return s.sent(),[2,t.status(500).send("server error.")];case 5:return[2]}}))}))},t.Logout=function(e,t){return e.session&&e.session.user&&(e.session.user=null),t.status(200).send({result:"ok"})},t.Register=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!(e.body.uid&&e.body.pwd&&e.body.email&&e.body.firstName&&e.body.lastName))return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.DbCollection("gifts-users")];case 2:return[4,r.sent().insertOne({uid:e.body.uid,pwd:u.encrypt(e.body.pwd),email:e.body.email,firstName:e.body.firstName,lastName:e.body.lastName,createdOn:new Date})];case 3:return 1===(n=r.sent()).insertedCount?[2,t.status(200).send(n.ops[0])]:[2,t.status(500).send("Register failed. Please try again later.")];case 4:return r.sent(),[2,t.status(500).send("Register failed. Please try again later.")];case 5:return[2]}}))}))},t.DeleteUser=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!e||!e.user)return[2,t.status(403).send("Login is required.")];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o.MongoDb()];case 2:return r.sent().collection("gifts-users").deleteOne({_id:e.user._id}),e.user=null,[2,t.status(200).send({result:"User deleted."})];case 3:return n=r.sent(),[2,t.status(400).send(n)];case 4:return[2]}}))}))},t.UserInfo=function(e,t){return i(e)?t.status(200).send({_id:e.user._id,uid:e.user.uid,email:e.user.email}):t.status(403).send("User Not login.")},t.bLogin=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(25),o="aes-192-cbc",u=s.scryptSync("inSGyc83","salt",24),i=Buffer.alloc(16,0);function a(e,t){var n="";if(e===r.String)n="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";else if(e===r.Number)n="0123456789";else{if(e!==r.Capital)return"";n="ABCDEFGHIJKLMNOPQRSTUVWXYZ"}for(var s="",o=t;o>0;--o)s+=n[Math.floor(Math.random()*n.length)];return s}t.encrypt=function(e){try{var t=s.createCipheriv(o,u,i),n=t.update(e,"utf8","hex");return n+=t.final("hex")}catch(e){}},t.decrypt=function(e){try{var t=s.createDecipheriv(o,u,i),n=t.update(e,"hex","utf8");return n+=t.final("utf8")}catch(e){}},function(e){e[e.Capital=0]="Capital",e[e.Number=1]="Number",e[e.String=2]="String"}(r||(r={})),t.RandomTypes=r,t.randomNumber=function(e){return a(r.Number,e)},t.randomCapitals=function(e){return a(r.Capital,e)},t.randomString=function(e){return a(r.String,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(9),o=n(10),u=n(11),i=n(12),a=n(13),c=n(33),l=r();l.use(u()),l.use(i.json()),l.use(i.urlencoded({extended:!1})),l.use(s({secret:c.randomString(20),resave:!1,saveUninitialized:!0,cookie:{maxAge:864e5}})),l.use("/api",a.default),l.get("/",(function(e,t){return t.status(200).sendFile(o.join(__dirname,"/client/index.html"))})),l.use(r.static(o.join(__dirname,"/client"))),l.use(r.static(o.join(__dirname,"/client/assets"),{dotfiles:"allow"})),l.all("/*",(function(e,t){return t.status(200).sendFile(o.join(__dirname,"/client/index.html"))})),l.use((function(e,t,n){return t.status(500).send("Issue happened. Please retry later!")})),l.listen(8080,(function(){console.log("App listening on port 8080.")}))},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("body-parser")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(14),o=n(16),u=n(18),i=n(29),a=n(31),c=r.Router();c.use("/lta/bus",s.busRouter),c.use("/dictionary",o.default),c.use("/gifts",u.default),c.use("/http",i.default),c.post("/msg",(function(e,t){a.default(e.body,t)})),c.all("/*",(function(e,t){return t.status(400).send("Invalid Request")})),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(15),o=n(4),u=r.Router();t.busRouter=u,u.get("/busArrival/:busStopCode",(function(e,t){s.default(e.params.busStopCode,t)})),u.get("/busStop/:busStopCode",(function(e,t){o.getBusStopInfo(e.params.busStopCode,t)})),u.get("/nearbyBusStops",(function(e,t){o.getNearbyBusStops(e.query.latitude,e.query.longitude,t)}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),s=n(3),o=n(4);t.default=function(e,t){if(!(e=e.trim()))return t.status(400).send("Invalid BusStopCode.");var n=o.checkBusStopLocally(e);if(!n)return t.status(400).send("Bus Stop not found.");var u=s.busArrivalUrl+"?BusStopCode="+e;r.default.get(u,s.headerConfig).then((function(e){t.status(200).send({busStopInfo:n,busArrival:e.data})})).catch((function(e){t.status(400).send(e)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(17),o=r.Router();o.get("/oxford/:word",(function(e,t){s.default(e.params.word,t)})),t.default=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),u={headers:{app_id:"0314e9e2",app_key:"5a6c2589474a2f83ccd69f397bfec7a2"}};function i(e,t){return r(this,void 0,void 0,(function(){var n,r,i,a,c,l,d,f,p,h,b,y,v,g,w,m,_,x,O,C,I,S,D,k,P,j,M,q,G;return s(this,(function(s){switch(s.label){case 0:if(!e||!e.trim())return[2,t.status(400).send("Invalid word.")];e=e.trim().toLowerCase(),n="https://od-api.oxforddictionaries.com/api/v2/entries/en-gb/"+e+"?fields=definitions%2Cpronunciations",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,o.default(n,u)];case 2:for(r=s.sent(),i=r.data,a={lexicalEntries:[]},c=0,l=i.results;c<l.length;c++)for(d=l[c],f=0,p=d.lexicalEntries;f<p.length;f++){for(h=p[f],b={entries:[],lexicalCategory:"",pronunciations:[]},a.lexicalEntries.push(b),h.lexicalCategory&&(b.lexicalCategory=h.lexicalCategory.text),y=0,v=h.entries;y<v.length;y++)for(g=v[y],w=0,m=g.senses;w<m.length;w++){for(_=m[w],x=0,O=_.definitions||[];x<O.length;x++)P=O[x],b.entries.push(P);for(C=0,I=_.subsenses||[];C<I.length;C++)for(S=I[C],D=0,k=S.definitions;D<k.length;D++)P=k[D],b.entries.push(P)}for(j=0,M=h.pronunciations;j<M.length;j++)q=M[j],b.pronunciations.push({audioFile:q.audioFile,phoneticSpelling:q.phoneticSpelling})}return[2,t.status(200).send(a)];case 3:return G=s.sent(),[2,t.status(400).send(G.message)];case 4:return[2]}}))}))}i("check",void 0),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(19),o=n(23),u=n(24),i=n(28),a=r.Router();a.use("/products",s.default),a.use("/orders",o.default),a.use("/users",u.default),a.use("/staffs",i.default),t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(20),o=n(22),u=n(5),i=r.Router();i.get("/view/:product_no",(function(e,t){o.GetProduct(e.params,t)})),i.get("/categories",(function(e,t){s.GetCategories(t)})),i.post("/category",(function(e,t){s.AddCategory(e.body,t)})),i.delete("/category",(function(e,t){s.DeleteCategory(e.query,t)})),i.get("/samples",(function(e,t){s.GetSamplesOfCategories(t)})),i.get("",(function(e,t){o.GetProductsByCategory(e,t)})),i.get("/product",(function(e,t){o.GetProduct(e.query,t)})),i.post("/product",(function(e,t){o.AddProduct(e.body,t)})),i.put("/product",(function(e,t){o.UpdateProduct(e.body,t)})),i.delete("/product",(function(e,t){o.DeleteProduct(e.query,t)})),i.get("/inventory",(function(e,t){u.GetInventory(t)})),i.put("/inventory",(function(e,t){u.AdjustInventory(e.body._id,e.body.qty,t)})),t.default=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),u=[],i=[];function a(e){return r(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if(!(u.length<=0))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c()];case 2:return u=n.sent(),[3,4];case 3:throw n.sent();case 4:return 0===e?[2,u]:(t=[],u.forEach((function(n){console.log(n.category.match(new RegExp("/","g"))),n.category.match(new RegExp("/","g")).length<=e&&t.push(n)})),[2,t])}}))}))}function c(){return r(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,o.DbCollection("gifts-products-catalog")];case 1:return[4,e.sent().find().sort("category",1).toArray()];case 2:return[2,u=e.sent()];case 3:throw e.sent(),{errMsg:"Get categories from database failed."};case 4:return[2]}}))}))}function l(){return r(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,o.DbCollection("gifts-products")];case 1:return e=n.sent(),null,[4,e.aggregate([{$sort:{_id:-1}},{$group:{_id:{category:"$category"},products:{$push:{_id:"$_id",category:"$category",img:"$img"}}}},{$project:{_id:"$_id",products:{$slice:["$products",4]}}}]).toArray()];case 2:return[2,n.sent()];case 3:return t=n.sent(),console.log(t),[2,{errMsg:"Get products failed."}];case 4:return[2]}}))}))}t.GetCategories=function(e){return r(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a(0)];case 1:return t=r.sent(),[2,e.status(200).send(t)];case 2:return n=r.sent(),[2,e.status(500).send(n)];case 3:return[2]}}))}))},t.GetSamplesOfCategories=function(e){return r(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if(i.length>0)return[2,e.status(200).send(i)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,l()];case 2:return i=n.sent(),[2,e.status(200).send(i)];case 3:return t=n.sent(),[2,e.status(500).send(t)];case 4:return[2]}}))}))},t.AddCategory=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!e.name||!e.category)return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.DbCollection("gifts-products-catalog")];case 2:return[4,r.sent().insertOne({name:e.name,category:e.category})];case 3:return r.sent(),u=[],i=[],[2,t.status(200).send({result:"ok"})];case 4:return n=r.sent(),[2,t.status(500).send(n)];case 5:return[2]}}))}))},t.DeleteCategory=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!e._id)return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.DbCollection("gifts-products-catalog")];case 2:return[4,r.sent().deleteOne({_id:new o.ObjectID(e._id)})];case 3:return r.sent(),u=[],i=[],[2,t.status(200).send({result:"ok"})];case 4:return n=r.sent(),[2,t.status(500).send(n)];case 5:return[2]}}))}))}},function(e,t){e.exports=require("mongodb")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.GetProduct=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return s(this,(function(s){switch(s.label){case 0:if(!e._id)return[2,t.status(400).send("Invalid product no.")];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,o.MongoDb()];case 2:return[4,s.sent().collection("gifts-products").findOne({_id:new o.ObjectID(e._id)})];case 3:return n=s.sent(),[2,t.status(200).send(n)];case 4:return r=s.sent(),[2,t.status(500).send(r)];case 5:return[2]}}))}))},t.GetProductsByCategory=function(e,t){return r(this,void 0,void 0,(function(){var n,r,u,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),[4,o.DbCollection("gifts-products")];case 1:return n=s.sent(),r=null,e.query.category?(u=new RegExp(["^",e.query.category.trim()].join(""),"i"),[4,n.find({category:u}).toArray()]):[3,3];case 2:return r=s.sent(),[3,5];case 3:return[4,n.find().toArray()];case 4:r=s.sent(),s.label=5;case 5:return[2,t.status(200).send(r)];case 6:return i=s.sent(),[2,t.status(500).send(i)];case 7:return[2]}}))}))},t.AddProduct=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!e.name)return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.MongoDb()];case 2:return[4,r.sent().collection("gifts-products").insertOne({name:e.name,img:e.img,price:e.price,category:e.category,color:e.color,packaging:e.packaging,material:e.material,size:e.size,note:e.note,retailer:e.retailer,createdOn:new Date})];case 3:return r.sent(),[2,t.status(200).send({result:"ok"})];case 4:return n=r.sent(),[2,t.status(500).send(n)];case 5:return[2]}}))}))},t.UpdateProduct=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!e._id)return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.DbCollection("gifts-products")];case 2:return[4,r.sent().updateOne({_id:new o.ObjectID(e._id)},{$set:{modifiedOn:new Date,name:e.name,img:e.img,price:e.price,category:e.category,color:e.color,packaging:e.packaging,material:e.material,size:e.size,note:e.note,retailer:e.retailer}})];case 3:return r.sent(),[2,t.status(200).send({result:"ok"})];case 4:return n=r.sent(),[2,t.status(500).send(n)];case 5:return[2]}}))}))},t.DeleteProduct=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!e._id)return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.MongoDb()];case 2:return[4,r.sent().collection("gifts-products").deleteOne({_id:new o.ObjectID(e._id)})];case 3:return r.sent(),[2,t.status(200).send({result:"ok"})];case 4:return n=r.sent(),[2,t.status(500).send(n)];case 5:return[2]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0).Router();r.get("/allOrders",(function(e,t){return e.session&&e.session.staff?t.status(200).send({result:"ok"}):t.sendStatus(401)})),r.put("/updateStatus",(function(e,t){if(!e.session||!e.session.staff.id)return t.sendStatus(401);if(!e.body.new_status||!e.body.sno||!e.body.order_no)return t.status(400).send("Failed. Pleaes review inputs.");e.body.order_no,e.body.sno,Date.now(),e.session.staff.id,e.body.new_status,e.body.note;return t.status(200).send({result:"ok"})})),r.put("/updateContact",(function(e,t){if(!e.session||!e.session.staff.id)return t.sendStatus(401);if(!e.body.order_no)return t.status(400).send("Order_no empty.");if(!(e.body.email&&e.body.email.includes("@")&&e.body.email.includes("."))||e.body.email.includes("/")||e.body.email.includes("\\"))return t.status(400).send("Invalid email.");if(!e.body.name)return t.status(400).send("Invalid name.");e.body.name,e.body.email,e.body.mobile,e.body.company,e.body.mobile2,e.body.addr,e.body.order_no;return t.status(200).send({result:"ok"})})),r.put("/updateOrderItem",(function(e,t){if(!e.session||!e.session.staff.id)return t.sendStatus(401);if(!e.body.order_no)return t.status(400).send("Failed. Invalid Order No.");if(!e.body.sno||""===e.body.sno)return t.status(400).send("Failed. Invalid Order Sno.");e.body.new_sale_price,e.body.new_qty,e.body.new_status,e.body.order_no,e.body.sno;return t.status(200).send({result:"ok"})})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(6),o=n(26),u=r.Router();u.post("/login",(function(e,t){s.Login(e,t)})),u.get("/info",(function(e,t){s.UserInfo(e.session,t)})),u.get("/logout",(function(e,t){s.Logout(e,t)})),u.post("/register",(function(e,t){s.Register(e,t)})),u.delete("/deleteuser",(function(e,t){s.DeleteUser(e.session,t)})),u.get("/cart",(function(e,t){o.GetCart(e.session,t)})),u.post("/cart",(function(e,t){o.AddToCart(e.session,e.body,t)})),u.delete("/cart",(function(e,t){o.DeleteCart(e.session,t)})),u.put("/cart",(function(e,t){o.UpdateCartQty(e,t)})),u.delete("/cart/product",(function(e,t){o.DeleteInCart(e.session,e.query._id,t)})),u.post("/cart/checkout",(function(e,t){o.CartCheckout(e,t)})),t.default=u},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),u=n(7),i=n(6),a=n(5),c=n(27);t.GetCart=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return s(this,(function(s){switch(s.label){case 0:if(!i.bLogin(e))return[2,t.status(403).send("User not login")];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,o.DbCollection("gifts-carts")];case 2:return[4,s.sent().findOne({_id:new o.ObjectID(e.user._id)})];case 3:return n=s.sent(),console.log(n),[2,t.status(200).send(n)];case 4:return r=s.sent(),[2,t.status(500).send(r)];case 5:return[2]}}))}))},t.AddToCart=function(e,t,n){return r(this,void 0,void 0,(function(){var r,u;return s(this,(function(s){switch(s.label){case 0:if(!i.bLogin(e))return[2,n.status(403).send("User not login")];s.label=1;case 1:return s.trys.push([1,5,,6]),[4,o.DbCollection("gifts-carts")];case 2:return[4,(r=s.sent()).updateOne({_id:new o.ObjectID(e.user._id)},{$pull:{products:{productId:new o.ObjectID(t.product._id)}}})];case 3:return s.sent(),[4,r.updateOne({_id:new o.ObjectID(e.user._id)},{$push:{products:{productId:new o.ObjectID(t.product._id),quantity:t.qty,name:t.product.name,price:t.product.price}}},{upsert:!0})];case 4:return s.sent(),[2,n.status(200).send({result:"ok"})];case 5:return u=s.sent(),[2,n.status(500).send(u)];case 6:return[2]}}))}))},t.UpdateCartQty=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(i.bLogin(e.session)||t.status(403).send("User not login."),!e.body.productId||!e.body.qty)return[2,t.status(400).send("Invalid input.")];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,o.MongoDb()];case 2:return[4,r.sent().collection("gifts-carts").updateOne({_id:e.session.user._id,"products.productId":e.body.productId},{$set:{"products.$.qty":e.body.qty,modifiedOn:new Date}})];case 3:return r.sent(),[2,t.status(200).send({result:"ok"})];case 4:return n=r.sent(),[2,t.status(500).send(n)];case 5:return[2]}}))}))},t.DeleteCart=function(e,t){return r(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if(!i.bLogin(e))return[2,t.status(400).send("User not login.")];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o.DbCollection("gifts-carts")];case 2:return r.sent().deleteOne({_id:new o.ObjectID(e.user._id)}),[2,t.status(200).send({result:"ok"})];case 3:return n=r.sent(),[2,t.status(500).send(n)];case 4:return[2]}}))}))},t.DeleteInCart=function(e,t,n){return r(this,void 0,void 0,(function(){var r;return s(this,(function(s){switch(s.label){case 0:if(!i.bLogin(e))return[2,n.status(400).send("User not login.")];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,o.DbCollection("gifts-carts")];case 2:return[4,s.sent().updateOne({_id:new o.ObjectID(e.user._id)},{$pull:{products:{productId:new o.ObjectID(t)}}})];case 3:return s.sent(),[2,n.status(200).send({result:"ok"})];case 4:return r=s.sent(),[2,n.status(500).send(r)];case 5:return[2]}}))}))},t.CartCheckout=function(e,t){return r(this,void 0,void 0,(function(){var n,r,l,d,f,p;return s(this,(function(s){switch(s.label){case 0:if(!(e.body.cart&&e.body.cart.customer&&e.body.cart.customer.name&&e.body.cart.customer.mobile&&e.body.cart.customer.address))return[2,t.status(400).send("Invalid customer information.")];if(e.body.cart.total<=0)return[2,t.status(400).send("No product to checkout.")];n=i.bLogin(e.session),r="",r=n?e.session.user._id:u.randomString(20),l=e.body.cart.cartItems,d=e.body.cart.customer,s.label=1;case 1:return s.trys.push([1,10,,11]),[4,a.ReserveInventory(r,l)];case 2:return s.sent(),[4,c.NewOrder(d,l)];case 3:return s.sent().result.n<=0?[4,a.DeleteInventoryReservation(r)]:[3,5];case 4:throw s.sent(),"Create new order failed.";case 5:return[4,a.DeleteInventoryReservation(r)];case 6:return f=s.sent(),console.log(f),n?[4,o.DbCollection("gifts-carts")]:[3,9];case 7:return[4,s.sent().deleteOne({_id:new o.ObjectID(r)})];case 8:s.sent(),s.label=9;case 9:return[2,t.status(200).send({orderId:r})];case 10:return p=s.sent(),console.error(p),[2,t.status(500).send(p)];case 11:return[2]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,i)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,s,o,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(s=2&o[0]?r.return:o[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,o[1])).done)return s;switch(r=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(s=(s=u.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.NewOrder=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,o.DbCollection("gifts-orders")];case 1:return n=s.sent(),r=n.insertOne({created_on:new Date,shipping:{name:e.name,mobile:e.mobile,address:e.address,message:e.message},payment:{method:"visa",transaction_id:"2312213312XXXTD"},cartItems:t}),console.log("insertRslt: ",r),[2,r];case 2:throw s.sent(),"create new order failed.";case 3:return[2]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0).Router();r.post("/login",(function(e,t){})),r.get("/logout",(function(e,t){})),r.post("/register",(function(e,t){})),r.delete("/deleteuser",(function(e,t){})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(30),o=r.Router();o.post("",(function(e,t){"DELETE"===e.body.type?s.Delete(e.body,t):"GET"===e.body.type?s.Get(e.body,t):"POST"===e.body.type?s.Post(e.body,t):"PUT"===e.body.type&&s.Put(e.body,t)})),t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.Delete=function(e,t){var n=e.url;if(e.querys&&e.querys.length>0){n+="?";for(var s=0;s<e.querys.length;++s)n+=e.query[s],n+="=",n+=e.queryValue[s]}r.default.delete(n).then((function(e){t.status(200).send(e)})).catch((function(e){t.status(400).send(e)}))},t.Post=function(e,t){return t.status(200).send(e)},t.Put=function(e,t){r.default.put(e.body.url).then((function(e){t.send(e.data)}))},t.Get=function(e,t){r.default.post(e.body.url).then((function(e){t.send(e.data)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(32).createTransport({host:"mail.insg.xyz",secure:!0,auth:{user:"i@insg.xyz",pass:"pass1234"}}),s={from:"i@insg.xyz",to:"seesea2@gmail.com",subject:"Hello",text:"This is email from InSG.xyz",html:"<b>this is email from InSG.xyz</b>"};t.default=function(e,t){r.sendMail(s)}},function(e,t){e.exports=require("nodemailer")},function(e,t,n){"use strict";var r;function s(e,t){var n="";switch(e){case r.String:n="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";break;case r.Number:n="0123456789";break;case r.Capital:n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";break;default:return""}for(var s="",o=t;o>0;--o)s+=n[Math.floor(Math.random()*n.length)];return s}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Capital=0]="Capital",e[e.Number=1]="Number",e[e.String=2]="String"}(r||(r={})),t.randomNumber=function(e){return s(r.Number,e)},t.randomCapitals=function(e){return s(r.Capital,e)},t.randomString=function(e){return s(r.String,e)}}]);
//# sourceMappingURL=server.js.map